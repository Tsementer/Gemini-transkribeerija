<!DOCTYPE html>
<html lang="et">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Gemini 2.5 Audio Transkribeerija</title>
Â  Â  <style>
Â  Â  Â  Â  * {
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  background: rgba(255, 255, 255, 0.95);
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(10px);
Â  Â  Â  Â  Â  Â  border-radius: 20px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  Â  Â  max-width: 800px;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 40px;
Â  Â  Â  Â  Â  Â  animation: fadeIn 0.5s ease;
Â  Â  Â  Â  }

Â  Â  Â  Â  @keyframes fadeIn {
Â  Â  Â  Â  Â  Â  from {
Â  Â  Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  Â  Â  transform: translateY(20px);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  to {
Â  Â  Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  Â  Â  transform: translateY(0);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  h1 {
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  margin-bottom: 30px;
Â  Â  Â  Â  Â  Â  font-size: 2.5em;
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea, #764ba2);
Â  Â  Â  Â  Â  Â  -webkit-background-clip: text;
Â  Â  Â  Â  Â  Â  -webkit-text-fill-color: transparent;
Â  Â  Â  Â  Â  Â  font-weight: 700;
Â  Â  Â  Â  }

Â  Â  Â  Â  h2 {
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  Â  Â  font-size: 1.8em;
Â  Â  Â  Â  }

Â  Â  Â  Â  .api-key-section {
Â  Â  Â  Â  Â  Â  margin-bottom: 30px;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  background: #f8f9fa;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .input-group {
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  label {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  margin-bottom: 8px;
Â  Â  Â  Â  Â  Â  color: #555;
Â  Â  Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  }

Â  Â  Â  Â  input[type="password"],Â 
Â  Â  Â  Â  input[type="file"] {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 12px;
Â  Â  Â  Â  Â  Â  border: 2px solid #e0e0e0;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  transition: border-color 0.3s;
Â  Â  Â  Â  }

Â  Â  Â  Â  input[type="password"]:focus,
Â  Â  Â  Â  input[type="file"]:focus {
Â  Â  Â  Â  Â  Â  outline: none;
Â  Â  Â  Â  Â  Â  border-color: #667eea;
Â  Â  Â  Â  }

Â  Â  Â  Â  .file-input-wrapper {
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  display: inline-block;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  }

Â  Â  Â  Â  .file-input-label {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  padding: 12px;
Â  Â  Â  Â  Â  Â  background: #f0f0f0;
Â  Â  Â  Â  Â  Â  border: 2px dashed #ccc;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: all 0.3s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .file-input-label:hover {
Â  Â  Â  Â  Â  Â  background: #e8e8e8;
Â  Â  Â  Â  Â  Â  border-color: #667eea;
Â  Â  Â  Â  }

Â  Â  Â  Â  input[type="file"] {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  left: -9999px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .button {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea, #764ba2);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  padding: 14px 30px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: transform 0.2s, box-shadow 0.2s;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .button:hover:not(:disabled) {
Â  Â  Â  Â  Â  Â  transform: translateY(-2px);
Â  Â  Â  Â  Â  Â  box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
Â  Â  Â  Â  }

Â  Â  Â  Â  .button:disabled {
Â  Â  Â  Â  Â  Â  opacity: 0.6;
Â  Â  Â  Â  Â  Â  cursor: not-allowed;
Â  Â  Â  Â  }

Â  Â  Â  Â  .status {
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  .status.info {
Â  Â  Â  Â  Â  Â  background: #e3f2fd;
Â  Â  Â  Â  Â  Â  color: #1976d2;
Â  Â  Â  Â  }

Â  Â  Â  Â  .status.success {
Â  Â  Â  Â  Â  Â  background: #e8f5e9;
Â  Â  Â  Â  Â  Â  color: #388e3c;
Â  Â  Â  Â  }

Â  Â  Â  Â  .status.error {
Â  Â  Â  Â  Â  Â  background: #ffebee;
Â  Â  Â  Â  Â  Â  color: #c62828;
Â  Â  Â  Â  }

Â  Â  Â  Â  .result-section {
Â  Â  Â  Â  Â  Â  margin-top: 30px;
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  .result-box {
Â  Â  Â  Â  Â  Â  background: #f8f9fa;
Â  Â  Â  Â  Â  Â  border: 1px solid #e0e0e0;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  Â  Â  max-height: 500px;
Â  Â  Â  Â  Â  Â  overflow-y: auto;
Â  Â  Â  Â  }

Â  Â  Â  Â  .transcript-segment {
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
Â  Â  Â  Â  Â  Â  transition: transform 0.2s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .transcript-segment:hover {
Â  Â  Â  Â  Â  Â  transform: translateX(5px);
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
Â  Â  Â  Â  }

Â  Â  Â  Â  .speaker-name {
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  color: #667eea;
Â  Â  Â  Â  Â  Â  margin-bottom: 5px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â    align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  }

Â  Â  Â  Â  .speaker-1 { color: #667eea; }
Â  Â  Â  Â  .speaker-2 { color: #e91e63; }
Â  Â  Â  Â  .speaker-3 { color: #00bcd4; }
Â  Â  Â  Â  .speaker-4 { color: #ff9800; }

Â  Â  Â  Â  .timestamp {
Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  color: #999;
Â  Â  Â  Â  Â  Â  margin-left: 10px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .segment-text {
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  line-height: 1.6;
Â  Â  Â  Â  Â  Â  margin-top: 8px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .export-buttons {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .export-button {
Â  Â  Â  Â  Â  Â  background: #28a745;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  padding: 8px 16px;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: background 0.3s;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  gap: 5px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .export-button:hover {
Â  Â  Â  Â  Â  Â  background: #218838;
Â  Â  Â  Â  }

Â  Â  Â  Â  .error-message {
Â  Â  Â  Â  Â  Â  background: #fee;
Â  Â  Â  Â  Â  Â  border: 1px solid #fcc;
Â  Â  Â  Â  Â  Â  color: #c00;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .model-info {
Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  color: #666;
Â  Â  Â  Â  Â  Â  margin-top: 5px;
Â  Â  Â  Â  Â  Â  font-style: italic;
Â  Â  Â  Â  }

Â  Â  Â  Â  .info-box {
Â  Â  Â  Â  Â  Â  background: #fef3c7;
Â  Â  Â  Â  Â  Â  border: 1px solid #f59e0b;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  color: #92400e;
Â  Â  Â  Â  }

Â  Â  Â  Â  .loader {
Â  Â  Â  Â  Â  Â  display: inline-block;
Â  Â  Â  Â  Â  Â  width: 20px;
Â  Â  Â  Â  Â  Â  height: 20px;
Â  Â  Â  Â  Â  Â  border: 3px solid #f3f3f3;
Â  Â  Â  Â  Â  Â  border-top: 3px solid #667eea;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  animation: spin 1s linear infinite;
Â  Â  Â  Â  Â  Â  margin-right: 10px;
Â  Â  Â  Â  Â  Â  vertical-align: middle;
Â  Â  Â  Â  }

Â  Â  Â  Â  @keyframes spin {
Â  Â  Â  Â  Â  Â  0% { transform: rotate(0deg); }
Â  Â  Â  Â  Â  Â  100% { transform: rotate(360deg); }
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>
Â  Â  <div class="container">
Â  Â  Â  Â  <h1>ğŸ™ï¸ Gemini 2.5 Audio Transkribeerija</h1>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="info-box">
Â  Â  Â  Â  Â  Â  âš ï¸ See rakendus vajab Google Gemini API vÃµtit. Saate selle luuaÂ 
Â  Â  Â  Â  Â  Â  <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a> kaudu.
Â  Â  Â  Â  Â  Â  <br><br>
Â  Â  Â  Â  Â  Â  âœ¨ <strong>Uuendused:</strong>Â 
Â  Â  Â  Â  Â  Â  <ul style="margin: 5px 0 0 20px; font-size: 14px;">
Â  Â  Â  Â  Â  Â  Â  Â  <li><strong>Gemini 2.5 Flash</strong> - uusim ja tÃ¤psem mudel ("thinking" toega)</li>
Â  Â  Â  Â  Â  Â  Â  Â  <li>Kolm mudelit valikus (1.5 Flash, 2.5 Flash, 1.5 Pro)</li>
Â  Â  Â  Â  Â  Â  Â  Â  <li>KÃµnelejate automaatne eristamine</li>
Â  Â  Â  Â  Â  Â  Â  Â  <li>TÃ¤psed ajatemplid ja struktureeritud vÃ¤ljund</li>
Â  Â  Â  Â  Â  Â  Â  Â  <li>6 keele tugi + automaatne tuvastus</li>
Â  Â  Â  Â  Â  Â  Â  Â  <li>Kiire reÅ¾iim (lÃ¼litab "thinking" vÃ¤lja)</li>
Â  Â  Â  Â  Â  Â  </ul>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="api-key-section">
Â  Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  Â  Â  <label for="apiKey">Gemini API vÃµti:</label>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="password" id="apiKey" placeholder="Sisestage oma API vÃµti siia">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="model">AI mudel:</label>
Â  Â  Â  Â  Â  Â  <select id="model" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; cursor: pointer; margin-bottom: 5px;">
Â  Â  Â  Â  Â  Â  Â  Â  <option value="gemini-1.5-flash">Gemini 1.5 Flash (Kiire)</option>
Â  Â  Â  Â  Â  Â  Â  Â  <option value="gemini-2.5-flash" selected>Gemini 2.5 Flash (Uusim, tÃ¤psem)</option>
Â  Â  Â  Â  Â  Â  Â  Â  <option value="gemini-1.5-pro">Gemini 1.5 Pro (VÃµimekam)</option>
Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  <div class="model-info">ğŸ’¡ Gemini 2.5 Flash on uusim mudel parema tÃ¤psusega</div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="fastMode">
Â  Â  Â  Â  Â  Â  Â  Â  <input type="checkbox" id="fastMode" name="fastMode">
Â  Â  Â  Â  Â  Â  Â  Â  Kasuta kiiret reÅ¾iimi (ainult 2.5 Flash mudelil)
Â  Â  Â  Â  Â  Â  </label>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="language">Transkriptsiooni keel:</label>
Â  Â  Â  Â  Â  Â  <select id="language" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; cursor: pointer;">
Â  Â  Â  Â  Â  Â  Â  Â  <option value="auto">Automaatne tuvastus</option>
Â  Â  Â  Â  Â  Â  Â  Â  <option value="et" selected>Eesti</option>
Â  Â  Â  Â  Â  Â  Â  Â  <option value="en">English</option>
Â  Â  Â  Â  Â  Â  Â  Â  <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
Â  Â  Â  Â  Â  Â  Â  Â  <option value="fi">Suomi</option>
Â  Â  Â  Â  Â  Â  Â  Â  <option value="lv">LatvieÅ¡u</option>
Â  Â  Â  Â  Â  Â  Â  Â  <option value="lt">LietuviÅ³</option>
Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="audioFile">Valige audiofail:</label>
Â  Â  Â  Â  Â  Â  <div class="file-input-wrapper">
Â  Â  Â  Â  Â  Â  Â  Â  <label for="audioFile" class="file-input-label" id="fileLabel">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ğŸ“ KlÃµpsake vÃµi lohistage audiofail siia
Â  Â  Â  Â  Â  Â  Â  Â  </label>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="file" id="audioFile" accept="audio/*">
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <button class="button" id="transcribeBtn" onclick="transcribeAudio()">
Â  Â  Â  Â  Â  Â  ğŸš€ Alusta transkribeerimist
Â  Â  Â  Â  </button>

Â  Â  Â  Â  <div class="status" id="status"></div>

Â  Â  Â  Â  <div class="result-section" id="resultSection">
Â  Â  Â  Â  Â  Â  <h2>ğŸ“ Transkriptsioon:</h2>
Â  Â  Â  Â  Â  Â  <div class="result-box" id="resultBox"></div>
Â  Â  Â  Â  Â  Â  <div class="export-buttons">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="export-button" onclick="copyToClipboard()">ğŸ“‹ Kopeeri tekst</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="export-button" onclick="downloadTranscript()">ğŸ’¾ Lae alla TXT</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="export-button" onclick="downloadJSON()">ğŸ“Š Lae alla JSON</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  let selectedFile = null;
Â  Â  Â  Â  let currentTranscription = null;

Â  Â  Â  Â  // Funktsioon, mis hangib "kiire reÅ¾iimi" ploki
Â  Â  Â  Â  function getFastModeSection() {
Â  Â  Â  Â  Â  Â  // See on korrektne viis leida Ã¼mbritsev div-element
Â  Â  Â  Â  Â  Â  return document.getElementById('fastMode').parentElement.parentElement;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Mudeli valiku muutmise kÃ¤sitlemine
Â  Â  Â  Â  document.getElementById('model').addEventListener('change', function(e) {
Â  Â  Â  Â  Â  Â  const fastModeSection = getFastModeSection();
Â  Â  Â  Â  Â  Â  if (e.target.value === 'gemini-2.5-flash') {
Â  Â  Â  Â  Â  Â  Â  Â  fastModeSection.style.display = 'block';
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  fastModeSection.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('fastMode').checked = false;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  // Faili valimise kÃ¤sitlemine
Â  Â  Â  Â  document.getElementById('audioFile').addEventListener('change', function(e) {
Â  Â  Â  Â  Â  Â  const file = e.target.files[0];
Â  Â  Â  Â  Â  Â  if (file) {
Â  Â  Â  Â  Â  Â  Â  Â  selectedFile = file;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('fileLabel').textContent = `âœ… Valitud: ${file.name}`;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  // Drag and drop funktsionaalsus
Â  Â  Â  Â  const fileLabel = document.getElementById('fileLabel');
Â  Â  Â  Â Â 
Â  Â  Â  Â  fileLabel.addEventListener('dragover', (e) => {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  fileLabel.style.background = '#e0e0e0';
Â  Â  Â  Â  });

Â  Â  Â  Â  fileLabel.addEventListener('dragleave', () => {
Â  Â  Â  Â  Â  Â  fileLabel.style.background = '#f0f0f0';
Â  Â  Â  Â  });

Â  Â  Â  Â  fileLabel.addEventListener('drop', (e) => {
Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  fileLabel.style.background = '#f0f0f0';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const file = e.dataTransfer.files[0];
Â  Â  Â  Â  Â  Â  if (file && file.type.startsWith('audio/')) {
Â  Â  Â  Â  Â  Â  Â  Â  selectedFile = file;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('audioFile').files = e.dataTransfer.files;
Â  Â  Â  Â  Â  Â  Â  Â  fileLabel.textContent = `âœ… Valitud: ${file.name}`;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  showStatus('Palun valige audiofail!', 'error');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  function showStatus(message, type) {
Â  Â  Â  Â  Â  Â  const status = document.getElementById('status');
Â  Â  Â  Â  Â  Â  status.textContent = message;
Â  Â  Â  Â  Â  Â  status.className = `status ${type}`;
Â  Â  Â  Â  Â  Â  status.style.display = 'block';
Â  Â  Â  Â  }

Â  Â  Â  Â  async function transcribeAudio() {
Â  Â  Â  Â  Â  Â  const apiKey = document.getElementById('apiKey').value.trim();
Â  Â  Â  Â  Â  Â  const language = document.getElementById('language').value;
Â  Â  Â  Â  Â  Â  const model = document.getElementById('model').value;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (!apiKey) {
Â  Â  Â  Â  Â  Â  Â  Â  showStatus('Palun sisestage API vÃµti!', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  if (!selectedFile) {
Â  Â  Â  Â  Â  Â  Â  Â  showStatus('Palun valige audiofail!', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const button = document.getElementById('transcribeBtn');
Â  Â  Â  Â  Â  Â  button.disabled = true;
Â  Â  Â  Â  Â  Â  button.innerHTML = '<span class="loader"></span> Transkribin...';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  showStatus('Konvertin audiofaili...', 'info');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const base64Audio = await fileToBase64(selectedFile);
Â  Â  Â  Â  Â  Â  Â  Â  const mimeType = selectedFile.type || 'audio/wav';
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  showStatus(`Saadan pÃ¤ringu Gemini API-le (${model})...`, 'info');
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  let languageInstruction = '';
Â  Â  Â  Â  Â  Â  Â  Â  if (language !== 'auto') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const languageNames = { 'et': 'Estonian', 'en': 'English', 'ru': 'Russian', 'fi': 'Finnish', 'lv': 'Latvian', 'lt': 'Lithuanian' };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  languageInstruction = `\n7. Transcribe in ${languageNames[language]} language`;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const requestBody = {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  contents: [{
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  parts: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  text: `Please transcribe this audio file following this exact format:\n\nIMPORTANT: Output the transcription EXACTLY in this JSON format:\n{\n  "segments": [\n    {\n      "speaker": "Speaker 1",\n      "start": "0:00",\n      "end": "0:15",\n      "text": "What the speaker said"\n    },\n    {\n      "speaker": "Speaker 2", \n      "start": "0:15",\n      "end": "0:28",\n      "text": "What the other speaker said"\n    }\n  ]\n}\n\nInstructions:\n1. Identify different speakers (Speaker 1, Speaker 2, etc.)\n2. Add timestamps in M:SS format\n3. Divide text into logical segments (max 2-3 sentences)\n4. Add punctuation\n5. Output ONLY the JSON, nothing else\n6. Keep speaker labels in English (Speaker 1, Speaker 2)${languageInstruction}`
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  inline_data: { mime_type: mimeType, data: base64Audio }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }],
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  generationConfig: { temperature: 0.1, topK: 1, topP: 0.8, maxOutputTokens: 8192 }
Â  Â  Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  Â  Â  if (document.getElementById('fastMode').checked && model === 'gemini-2.5-flash') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  requestBody.thinkingConfig = { thinkingBudget: 0 };
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`, {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify(requestBody)
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const error = await response.json();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(error.error?.message || 'API pÃ¤ring ebaÃµnnestus');
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  const data = await response.json();
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (data.candidates && data.candidates[0]?.content?.parts?.[0]?.text) {
                    let responseText = data.candidates[0].content.parts[0].text;

                    const jsonRegex = /```json\s*([\s\S]*?)\s*```/;
                    const match = responseText.match(jsonRegex);

                    if (match && match[1]) {
                        responseText = match[1];
                    }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const transcriptionData = JSON.parse(responseText);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (transcriptionData.segments) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  displayResult(transcriptionData);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showStatus('Transkribeerimine Ãµnnestus!', 'success');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .
